---
description: Email Vulnerability notifications for HIGH and CRITICAL issues to users
enabled: true
entry_point: workflows/send.vulnerability.email.yaml
name: send.vulnerability.email
parameters:
    db_file_path:
        description: "File path to Sqlite3 DB"
        required: true
        type: string
        default: ~/greenbone/Greenbone.db"
    email_from:
        description: "Email address to send email from"
        required: true
        type: string
        default: "stackstorm-email@example.com"
    header:
        description: "Email Standard Header filepath"
        required: true
        type: string
        default: "~/html_files/header.html"
    footer:
        description: "Email Standard Footer filepath"
        required: true
        type: string
        default: "~/html_files/footer.html"
    subject:
        description: "Email subject tag line"
        required: true
        type: string
        default: "Greenbone Scan Results: Critical or High Vulnerabilities"
    smtp_account:
        description: "SMTP Account to use. Must be configured in email.yaml"
        required: true
        type: string
        default: "default"
    attachments_tmp_dir_path:
        description: "Dir path to store temporary csv attachment files"
        required: true
        type: string
        default: "~/stackstorm_workspace/tmp/"
    send_html:
        description: "Send Email Body as HTML"
        default: true
        required: true
        type: boolean
    admin_override:
        description: "Overrides email sending to send to a single email for testing purposes"
        required: true
        type: boolean
        default: true  # Change to False before adding to prod
    admin_override_email:
        description: "Admin override emailing - send all emails to these addresses for testing"
        required: true
        type: array
        default:
            - "admin@example.com"
runner_type: orquesta
